<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SALONIX - Customer Management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@500;700&family=Jost:wght@700&family=Poppins:wght@300;400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #333843;
            overflow-x: hidden;
            background: #f5f5f5;
        }

        /* ==================== BACKGROUND ==================== */
        .admin-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .admin-bg-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .admin-bg-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: blur(4.5px);
            background: rgba(0, 0, 0, 0.3);
        }

        /* ==================== ADMIN LAYOUT ==================== */
        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* ==================== SIDEBAR ==================== */
        .sidebar {
            width: 264px;
            background: #FFF;
            border-right: 1px solid #F0F1F3;
            box-shadow: 4px 0 30px 0 rgba(131, 98, 234, 0.05);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px 20px;
            height: 80px;
            border-bottom: 1px solid #F0F1F3;
        }

        .sidebar-logo img {
            width: 100px;
            height: 79px;
            object-fit: contain;
        }

        .sidebar-menu {
            flex: 1;
            padding: 24px 18px 32px 18px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow-y: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: rgba(0, 0, 0, 0.6);
            font-size: 14px;
            font-weight: 600;
            line-height: 20px;
            text-decoration: none;
        }

        .menu-item:hover {
            background: #F9F9FC;
        }

        .menu-item.active {
            background: #5C59E8;
            color: #FFF;
        }
        
        .menu-item img {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            object-fit: contain;
        }

        /* ==================== MAIN CONTENT ==================== */
        .main-content {
            flex: 1;
            margin-left: 264px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: transparent;
            position: relative;
        }

        /* ==================== TOP BAR ==================== */
        .top-bar {
            display: flex;
            align-items: center;
            padding: 16px 32px;
            background: #FFF;
            border-bottom: 1px solid #F0F1F3;
            box-shadow: 0 4px 30px 0 rgba(131, 98, 234, 0.05);
            height: 80px;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .top-bar-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .menu-toggle {
            display: none;
            cursor: pointer;
            padding: 8px;
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: #333843;
        }

        .top-bar-right {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .admin-user {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #E0E2E7;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #5C59E8;
        }

        .user-avatar::after {
            content: '';
            position: absolute;
            right: -2px;
            bottom: -2px;
            width: 10px;
            height: 10px;
            background: #3DA172;
            border: 2px solid #FFF;
            border-radius: 50%;
        }

        .user-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .user-name {
            font-size: 14px;
            font-weight: 500;
            color: #1A1C21;
        }

        .user-role {
            font-size: 12px;
            font-weight: 500;
            color: #667085;
        }

        /* ==================== CONTENT AREA ==================== */
        .content-area {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            position: relative;
        }

        /* ==================== PAGE HEADER ==================== */
        .page-header {
            margin-bottom: 24px;
        }

        .page-header h1 {
            font-size: 24px;
            font-weight: 600;
            color: #333843;
            margin-bottom: 8px;
        }

        .page-header p {
            font-size: 14px;
            color: #667085;
        }

        /* ==================== CARD ==================== */
        .card {
            background: #FFF;
            border-radius: 12px;
            border: 1px solid #E0E2E7;
            box-shadow: 0 1px 3px 0 rgba(16, 24, 40, 0.10);
            overflow: hidden;
        }

        .card-header {
            padding: 24px;
            border-bottom: 1px solid #F0F1F3;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #333843;
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border: 1px solid #D0D5DD;
            border-radius: 8px;
            background: #FFF;
            min-width: 300px;
            transition: all 0.3s;
        }

        .search-box:focus-within {
            border-color: #5C59E8;
            box-shadow: 0 0 0 3px rgba(92, 89, 232, 0.1);
        }

        .search-box input {
            flex: 1;
            border: none;
            background: transparent;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            color: #333843;
            outline: none;
        }

        .search-box input::placeholder {
            color: #667085;
        }

        /* ==================== TABLE ==================== */
        .table-responsive {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
        }

        .data-table thead {
            background: #F9F9FC;
        }

        .data-table th {
            padding: 16px 24px;
            text-align: left;
            font-size: 14px;
            font-weight: 600;
            color: #333843;
            border-bottom: 1px solid #F0F1F3;
            white-space: nowrap;
        }

        .data-table td {
            padding: 16px 24px;
            font-size: 14px;
            color: #667085;
            border-bottom: 1px solid #F0F1F3;
        }

        .data-table tbody tr {
            transition: background-color 0.2s;
        }

        .data-table tbody tr:hover {
            background: #F9F9FC;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .btn-view {
            background: #624DE3;
        }

        .btn-view:hover {
            background:  #5243c7;
        }

        .btn-edit {
            background: #624DE3;
        }

        .btn-edit:hover {
            background: #5243c7;
        }

        .btn-delete {
            background: #E34D57;
        }

        .btn-delete:hover {
            background: #d43f49;
        }

        /* ==================== LOADING ==================== */
        .loading {
            padding: 40px;
            text-align: center;
            color: #667085;
            font-size: 14px;
        }

        .error {
            padding: 40px;
            text-align: center;
            color: #F04438;
            font-size: 14px;
        }

        /* ==================== MODALS ==================== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: #FFF;
            border-radius: 16px;
            box-shadow: 0 4px 4px 0 rgba(44, 0, 27, 0.25);
            padding: 0;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        .modal.modal-sm {
            max-width: 480px;
        }

        .modal.modal-lg {
            max-width: 800px;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Modal Header */
        .modal-header {
            padding: 24px 32px;
            border-bottom: 1px solid #F0F1F3;
            background: #FFF;
            border-radius: 16px 16px 0 0;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #101828;
            margin: 0;
        }

        .modal-subtitle {
            font-size: 14px;
            color: #667085;
            margin-top: 4px;
        }

        /* Modal Body */
        .modal-body {
            padding: 32px;
        }

        /* Customer Details Modal */
        .customer-details-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding-bottom: 16px;
            border-bottom: 1px solid #EAECF0;
        }

        .detail-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .detail-label {
            font-size: 14px;
            font-weight: 500;
            color: #667085;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-size: 16px;
            font-weight: 500;
            color: #101828;
        }

        .password-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .password-dots {
            font-size: 20px;
            letter-spacing: 2px;
            color: #101828;
        }

        .show-password-btn {
            background: none;
            border: none;
            color: #624DE3;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }

        .show-password-btn:hover {
            background: #F9F9FC;
        }

        /* Edit Form Styles */
        .edit-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 500;
            color: #344054;
            display: block;
        }

        .form-label.required::after {
            content: "*";
            color: #F04438;
            margin-left: 4px;
        }

        .form-input {
            padding: 12px 16px;
            border: 1px solid #D0D5DD;
            border-radius: 8px;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            color: #101828;
            outline: none;
            transition: all 0.2s;
            width: 100%;
        }

        .form-input:focus {
            border-color: #624DE3;
            box-shadow: 0 0 0 3px rgba(92, 89, 232, 0.1);
        }

        .form-input::placeholder {
            color: #98A2B3;
        }

        .password-input-group {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #667085;
            cursor: pointer;
            font-size: 14px;
        }

        /* Modal Footer */
        .modal-footer {
            padding: 24px 32px;
            border-top: 1px solid #F0F1F3;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            background: #FFF;
            border-radius: 0 0 16px 16px;
        }

        /* Button Styles */
        .btn-modal {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
            min-width: 120px;
        }

        .btn-modal-secondary {
            background: #FFF;
            border-color: #D0D5DD;
            color: #344054;
        }

        .btn-modal-secondary:hover {
            background: #F9F9FC;
            border-color: #D0D5DD;
        }

        .btn-modal-primary {
            background: #624DE3;
            border-color: #624DE3;
            color: #FFF;
        }

        .btn-modal-primary:hover {
            background: #5242d4;
            border-color: #5242d4;
        }

        .btn-modal-danger {
            background: #F04438;
            border-color: #F04438;
            color: #FFF;
        }

        .btn-modal-danger:hover {
            background: #D92D20;
            border-color: #D92D20;
        }

        .btn-modal-success {
            background: #12B76A;
            border-color: #12B76A;
            color: #FFF;
        }

        .btn-modal-success:hover {
            background: #079455;
            border-color: #079455;
        }

        /* Delete Confirmation Modal */
        .delete-confirmation {
            text-align: center;
            padding: 40px 32px;
        }

        .delete-icon {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            background: #FEF3F2;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
        }

        .delete-icon svg {
            width: 32px;
            height: 32px;
            color: #F04438;
        }

        .delete-title {
            font-size: 20px;
            font-weight: 600;
            color: #101828;
            margin-bottom: 8px;
        }

        .delete-message {
            font-size: 14px;
            color: #667085;
            line-height: 1.5;
            margin-bottom: 32px;
        }

        /* Success Modal */
        .success-modal {
            text-align: center;
            padding: 40px 32px;
        }

        .success-icon {
            width: 72px;
            height: 72px;
            border-radius: 50%;
            background: #ECFDF3;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
        }

        .success-icon svg {
            width: 32px;
            height: 32px;
            color: #12B76A;
        }

        .success-title {
            font-size: 20px;
            font-weight: 600;
            color: #101828;
            margin-bottom: 8px;
        }

        .success-message {
            font-size: 14px;
            color: #667085;
            line-height: 1.5;
            margin-bottom: 32px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block;
            }

            .top-bar {
                padding: 16px 20px;
            }

            .content-area {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .card-header {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                min-width: 100%;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                text-align: center;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-footer {
                flex-direction: column;
            }

            .btn-modal {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Background -->
    <div class="admin-bg">
        <img src="https://api.builder.io/api/v1/image/assets/TEMP/1952c35b9d9f3235ef7d57200dcbbf59971acb5d?width=2880" alt="Background" class="admin-bg-image">
        <div class="admin-bg-overlay"></div>
    </div>

    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-logo">
                <img src="https://tinyurl.com/2k72rnvp" alt="SALONIX Logo">
            </div>
            
            <nav class="sidebar-menu">
                <a href="admin-dashboard.html" class="menu-item">
                    <img src="images/dashboard-sidebar.png" alt="Dashboard">
                    Dashboard
                </a>

                <a href="admin-appointments.jsp" class="menu-item">
                    <img src="images/appointment-sidebar.png" alt="Appointments">
                    Appointments
                </a>

                <a href="admin-customers.html" class="menu-item active">
                    <img src="images/customer-sidebar.png" alt="Customers">
                    Customers
                </a>

                <a href="admin-services.html" class="menu-item">
                    <img src="images/service-sidebar.png" alt="Services">
                    Services
                </a>

                <a href="admin-staffs.html" class="menu-item">
                    <img src="images/staff-sidebar.png" alt="Staffs">
                    Staffs
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="top-bar-left">
                    <div class="menu-toggle" onclick="toggleSidebar()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path d="M3 7C3 6.44772 3.44772 6 4 6H20C20.5523 6 21 6.44772 21 7C21 7.55228 20.5523 8 20 8H4C3.44772 8 3 7.55228 3 7Z" fill="#667085"/>
                            <path d="M3 12C3 11.4477 3.44772 11 4 11H20C20.5523 11 21 11.4477 21 12C21 12.5523 20.5523 13 20 13H4C3.44772 13 3 12.5523 3 12Z" fill="#667085"/>
                            <path d="M4 16C3.44772 16 3 16.4477 3 17C3 17.5523 3.44772 18 4 18H20C20.5523 18 21 17.5523 21 17C21 16.4477 20.5523 16 20 16H4Z" fill="#667085"/>
                        </svg>
                    </div>
                    <div class="page-title">Customers</div>
                </div>
                
                <div class="top-bar-right">
                    <div class="admin-user">
                        <div class="user-avatar">
                        </div>
                        <div class="user-info">
                            <div class="user-name" id="adminName"></div>
                            <div class="user-role">Admin</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <div class="page-header">
                    <h1>List of Customers</h1>
                    <p>Manage and view all customer information</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Customer Records</div>
                        <div class="search-box">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M14.7847 16.1991C11.6462 18.6416 7.10654 18.4205 4.22181 15.5358C1.09761 12.4116 1.09761 7.34625 4.22181 4.22205C7.346 1.09786 12.4113 1.09786 15.5355 4.22205C18.4202 7.10677 18.6414 11.6464 16.1989 14.7849L20.4853 19.0713C20.8758 19.4618 20.8758 20.095 20.4853 20.4855C20.0948 20.876 19.4616 20.876 19.0711 20.4855L14.7847 16.1991ZM5.63602 14.1215C7.97917 16.4647 11.7782 16.4647 14.1213 14.1215C16.4644 11.7784 16.4644 7.97941 14.1213 5.63627C11.7782 3.29312 7.97917 3.29312 5.63602 5.63627C3.29288 7.97941 3.29288 11.7784 5.63602 14.1215Z" fill="#667085"/>
                            </svg>
                            <input type="text" placeholder="Search customers..." id="searchInput">
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Customer ID</th>
                                    <th>Name</th>
                                    <th>Email Address</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="customerTableBody">
                                <!-- Data will be loaded from database -->
                                <tr>
                                    <td colspan="4" class="loading">Loading customers...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODALS -->
    
    <!-- Customer View Modal -->
    <div id="customerViewModal" class="modal-overlay" onclick="closeModal('customerViewModal')">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title">Customer Details</h2>
                <div class="modal-subtitle">View complete customer information</div>
            </div>
            <div class="modal-body">
                <div class="customer-details-grid">
                    <div class="detail-item">
                        <div class="detail-label">Customer ID</div>
                        <div class="detail-value" id="viewCustomerId">CUS001</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Full Name</div>
                        <div class="detail-value" id="viewCustomerName">Loading...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Email Address</div>
                        <div class="detail-value" id="viewCustomerEmail">Loading...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Phone Number</div>
                        <div class="detail-value" id="viewCustomerPhone">Loading...</div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-label">Password</div>
                        <div class="detail-value">
                            <div class="password-display">
                                <span class="password-dots" id="viewPasswordDots">••••••••</span>
                                <button class="show-password-btn" onclick="toggleViewPassword()">Show</button>
                            </div>
                            <input type="text" id="viewPasswordText" class="form-input" style="display: none;" readonly value="">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-secondary" onclick="closeModal('customerViewModal')">Back</button>
                <button class="btn-modal btn-modal-primary" onclick="switchToEditFromView()">Edit</button>
                <button class="btn-modal btn-modal-danger" onclick="switchToDeleteFromView()">Delete</button>
            </div>
        </div>
    </div>

    <!-- Customer Edit Modal -->
    <div id="customerEditModal" class="modal-overlay" onclick="closeModal('customerEditModal')">
        <div class="modal modal-lg" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 class="modal-title">Edit Customer Details</h2>
                <div class="modal-subtitle">Update customer information</div>
            </div>
            <div class="modal-body">
                <form class="edit-form" id="editCustomerForm" onsubmit="saveCustomerEdit(event)">
                    <div class="form-group">
                        <label class="form-label required">Full Name</label>
                        <input type="text" class="form-input" id="editCustomerName" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label required">Email Address</label>
                            <input type="email" class="form-input" id="editCustomerEmail" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label required">Phone Number</label>
                            <input type="tel" class="form-input" id="editCustomerPhone" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label required">Password</label>
                        <div class="password-input-group">
                            <input type="password" class="form-input" id="editCustomerPassword" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('editCustomerPassword', this)">Show</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label required">Confirm Password</label>
                        <div class="password-input-group">
                            <input type="password" class="form-input" id="editCustomerPasswordConfirm" required>
                            <button type="button" class="toggle-password" onclick="togglePassword('editCustomerPasswordConfirm', this)">Show</button>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn-modal btn-modal-secondary" onclick="closeModal('customerEditModal')">Cancel</button>
                <button class="btn-modal btn-modal-primary" onclick="saveCustomerEdit()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="customerDeleteModal" class="modal-overlay" onclick="closeModal('customerDeleteModal')">
        <div class="modal modal-sm" onclick="event.stopPropagation()">
            <div class="delete-confirmation">
                <div class="delete-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M15 9L9 15" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 9L15 15" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="delete-title">Confirm Delete</h3>
                <p class="delete-message">
                    Are you sure you want to permanently delete <strong id="deleteCustomerName">Customer Name</strong>? 
                    This action is irreversible and all associated data will be removed.
                </p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button class="btn-modal btn-modal-secondary" onclick="closeModal('customerDeleteModal')">Cancel</button>
                    <button class="btn-modal btn-modal-danger" onclick="confirmCustomerDelete()">Delete Customer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal (Update) -->
    <div id="updateSuccessModal" class="modal-overlay" onclick="closeModal('updateSuccessModal')">
        <div class="modal modal-sm" onclick="event.stopPropagation()">
            <div class="success-modal">
                <div class="success-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.709 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.86" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22 4L12 14.01L9 11.01" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="success-title">Success!</h3>
                <p class="success-message">Customer details have been updated successfully.</p>
                <button class="btn-modal btn-modal-primary" onclick="closeModal('updateSuccessModal')">Okay</button>
            </div>
        </div>
    </div>

    <!-- Success Modal (Delete) -->
    <div id="deleteSuccessModal" class="modal-overlay" onclick="closeModal('deleteSuccessModal')">
        <div class="modal modal-sm" onclick="event.stopPropagation()">
            <div class="success-modal">
                <div class="success-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.709 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.86" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M22 4L12 14.01L9 11.01" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="success-title">Deleted Successfully</h3>
                <p class="success-message">The customer account has been permanently deleted.</p>
                <button class="btn-modal btn-modal-primary" onclick="closeModal('deleteSuccessModal')">Okay</button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const BASE_URL = "/SABS";
        let currentCustomerId = null;
        let currentCustomerName = "";
        
        fetch(`${BASE_URL}/AdminServlet`)
        .then(res => res.text())
        .then(name => {
        document.getElementById("adminName").textContent = name && name.trim() !== "" ? name : "Admin";
        })
        .catch(() => {
        document.getElementById("adminName").textContent = "Admin";
        });

        // Password toggle functions
        function toggleViewPassword() {
            const dots = document.getElementById('viewPasswordDots');
            const text = document.getElementById('viewPasswordText');
            const btn = document.querySelector('.show-password-btn');
            
            if (dots.style.display !== 'none') {
                dots.style.display = 'none';
                text.style.display = 'block';
                btn.textContent = 'Hide';
            } else {
                dots.style.display = 'inline';
                text.style.display = 'none';
                btn.textContent = 'Show';
            }
        }

        function togglePassword(inputId, button) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = 'Hide';
            } else {
                input.type = 'password';
                button.textContent = 'Show';
            }
        }

        // Load customers from database - FIXED VERSION
        function loadCustomers() {
            const tableBody = document.getElementById('customerTableBody');
            
            // Show loading
            tableBody.innerHTML = '<tr><td colspan="4" class="loading">Loading customers...</td></tr>';
            
            console.log('Fetching customers from servlet...');
            
            // Fetch data from Servlet
            fetch(`${BASE_URL}/adminCustomerServlet`)
                .then(response => {
                    console.log('Response status:', response.status);
                    console.log('Response ok:', response.ok);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    // Get response as text first to see what we're getting
                    return response.text();
                })
                .then(text => {
                    console.log('Received text:', text.substring(0, 500) + '...');
                    
                    // Check if we got valid HTML table rows
                    if (text && text.trim() !== '') {
                        if (text.includes('<tr>') || text.includes('<td>')) {
                            // Replace the entire table body with the received HTML
                            tableBody.innerHTML = text;
                            console.log('Successfully loaded HTML table rows');
                            
                            // Update button styles
                            setTimeout(updateTableButtons, 100);
                        } else {
                            // No table data received
                            tableBody.innerHTML = '<tr><td colspan="4" class="loading">No customers found</td></tr>';
                            console.log('No table rows found in response');
                        }
                    } else {
                        // Empty response
                        tableBody.innerHTML = '<tr><td colspan="4" class="loading">No customers found</td></tr>';
                        console.log('Empty response from server');
                    }
                })
                .catch(error => {
                    console.error('Error loading customers:', error);
                    tableBody.innerHTML = '<tr><td colspan="4" class="error">Error loading customers. Please check console and try again.</td></tr>';
                });
        }

        // Update table buttons with proper styling
        function updateTableButtons() {
            const rows = document.querySelectorAll('#customerTableBody tr');
            
            console.log(`Found ${rows.length} rows to update`);
            
            rows.forEach((row, index) => {
                const actionCell = row.querySelector('td:last-child');
                const customerIdCell = row.querySelector('td:first-child');
                const nameCell = row.querySelector('td:nth-child(2)');
                
                if (actionCell && customerIdCell && nameCell) {
                    const customerId = customerIdCell.textContent.trim();
                    const customerName = nameCell.textContent.trim();
                    
                    console.log(`Row ${index}: ID=${customerId}, Name=${customerName}`);
                    
                    // Only update if the cell doesn't already have styled buttons
                    if (!actionCell.querySelector('.action-buttons')) {
                        // Extract any existing onclick attributes if present
                        const existingButtons = actionCell.querySelectorAll('button');
                        let hasValidButtons = false;
                        
                        // Check if buttons already have onclick handlers
                        existingButtons.forEach(btn => {
                            const onclickAttr = btn.getAttribute('onclick');
                            if (onclickAttr && onclickAttr.includes('openViewModal') || 
                                onclickAttr && onclickAttr.includes('openEditModal') ||
                                onclickAttr && onclickAttr.includes('deleteCustomer')) {
                                hasValidButtons = true;
                            }
                        });
                        
                        // If we don't have valid buttons, create them
                        if (!hasValidButtons) {
                            actionCell.innerHTML = `
                                <div class="action-buttons">
                                    <button class="btn btn-view" onclick="viewCustomer('${customerId}', '${customerName.replace(/'/g, "\\'")}')">View</button>
                                    <button class="btn btn-edit" onclick="editCustomer('${customerId}', '${customerName.replace(/'/g, "\\'")}')">Edit</button>
                                    <button class="btn btn-delete" onclick="deleteCustomer('${customerId}', '${customerName.replace(/'/g, "\\'")}')">Delete</button>
                                </div>
                            `;
                        } else {
                            // If we already have buttons, just add the CSS classes
                            existingButtons.forEach((btn, btnIndex) => {
                                if (btnIndex === 0) {
                                    btn.className = 'btn btn-view';
                                    btn.setAttribute('onclick', `viewCustomer('${customerId}', '${customerName.replace(/'/g, "\\'")}')`);
                                } else if (btnIndex === 1) {
                                    btn.className = 'btn btn-edit';
                                    btn.setAttribute('onclick', `editCustomer('${customerId}', '${customerName.replace(/'/g, "\\'")}')`);
                                } else if (btnIndex === 2) {
                                    btn.className = 'btn btn-delete';
                                    btn.setAttribute('onclick', `deleteCustomer('${customerId}', '${customerName.replace(/'/g, "\\'")}')`);
                                }
                            });
                        }
                    }
                }
            });
            
            console.log('Finished updating table buttons');
        }

        // View customer details
        function viewCustomer(customerId, customerName) {
            console.log('Viewing customer:', customerId, customerName);
            
            currentCustomerId = customerId;
            currentCustomerName = customerName;
            
            // Update modal with basic info immediately
            document.getElementById('viewCustomerId').textContent = customerId;
            document.getElementById('viewCustomerName').textContent = customerName;
            
            // Fetch detailed customer info for the modal
            fetch(`${BASE_URL}/adminCustomerServlet?id=${customerId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Failed to fetch customer details');
                }
                return response.json();
            })
            .then(customer => {
                console.log('Customer details fetched:', customer);
                
                // Update modal with customer data
                document.getElementById('viewCustomerId').textContent = customer.id || customerId;
                document.getElementById('viewCustomerEmail').textContent = customer.email || 'Not available';
                document.getElementById('viewCustomerPhone').textContent = customer.phone || 'Not available';
                
                // Set password value
                const passwordText = document.getElementById('viewPasswordText');
                passwordText.value = customer.password || '';
                
                // Open the view modal
                openModal('customerViewModal');
            })
            .catch(error => {
                console.error('Error fetching customer details:', error);
                // Still open modal with basic info
                openModal('customerViewModal');
            });
        }

        // Edit customer
        function editCustomer(customerId, customerName) {
            console.log('Editing customer:', customerId, customerName);
            
            currentCustomerId = customerId;
            currentCustomerName = customerName;
            
            // Set current name in form
            document.getElementById('editCustomerName').value = customerName;
            
            // Fetch customer details for editing
            fetch(`${BASE_URL}/adminCustomerServlet?id=${customerId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            })
            .then(response => {
                if (!response.ok) throw new Error('Failed to fetch customer');
                return response.json();
            })
            .then(customer => {
                console.log('Edit customer data:', customer);
                
                // Populate edit form
                document.getElementById('editCustomerEmail').value = customer.email || '';
                document.getElementById('editCustomerPhone').value = customer.phone || '';
                document.getElementById('editCustomerPassword').value = customer.password || '';
                document.getElementById('editCustomerPasswordConfirm').value = customer.password || '';
                
                // Open the edit modal
                openModal('customerEditModal');
            })
            .catch(error => {
                console.error('Error fetching customer for edit:', error);
                // Open modal anyway with basic info
                openModal('customerEditModal');
            });
        }

        // Save edited customer
        function saveCustomerEdit(event) {
            if (event) event.preventDefault();
            
            const name = document.getElementById('editCustomerName').value;
            const email = document.getElementById('editCustomerEmail').value;
            const phone = document.getElementById('editCustomerPhone').value;
            const password = document.getElementById('editCustomerPassword').value;
            const confirmPassword = document.getElementById('editCustomerPasswordConfirm').value;
            
            // Validate form
            if (!name || !email || !password) {
                alert('Please fill in all required fields');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
            
            const formData = new URLSearchParams({
                action: 'update',
                id: currentCustomerId,
                name: name,
                email: email,
                password: password,
                phone: phone
            });
            
            console.log('Saving customer data:', formData.toString());
            
            fetch(`${BASE_URL}/adminCustomerServlet`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: formData
            })
            .then(response => {
                console.log('Save response status:', response.status);
                if (response.ok) {
                    return response.text();
                } else {
                    throw new Error('Server error');
                }
            })
            .then(result => {
                console.log('Save result:', result);
                
                // Reload the customer list
                loadCustomers();
                
                // Close modal
                closeModal('customerEditModal');
                
                // Show success message
                setTimeout(() => {
                    openModal('updateSuccessModal');
                }, 300);
            })
            .catch(error => {
                console.error('Error updating customer:', error);
                alert('Error updating customer: ' + error.message);
            });
        }

        // Delete customer
        function deleteCustomer(customerId, customerName) {
            console.log('Deleting customer:', customerId, customerName);
            
            currentCustomerId = customerId;
            currentCustomerName = customerName;
            
            // Update delete confirmation message
            document.getElementById('deleteCustomerName').textContent = customerName;
            
            openModal('customerDeleteModal');
        }

        // Confirm customer deletion
        function confirmCustomerDelete() {
            console.log('Confirming deletion of customer:', currentCustomerId);
            
            fetch(`${BASE_URL}/adminCustomerServlet?id=${currentCustomerId}`, {
                method: 'DELETE'
            })
            .then(response => {
                console.log('Delete response status:', response.status);
                if (response.ok) {
                    return response.text();
                } else {
                    throw new Error('Delete failed');
                }
            })
            .then(result => {
                console.log('Delete result:', result);
                
                if (result === '1' || result.includes('success') || result.trim() === '1') {
                    // Reload the customer list
                    loadCustomers();
                    
                    // Close modal
                    closeModal('customerDeleteModal');
                    
                    // Show success message
                    setTimeout(() => {
                        openModal('deleteSuccessModal');
                    }, 300);
                } else {
                    alert('Error deleting customer. Server returned: ' + result);
                }
            })
            .catch(error => {
                console.error('Error deleting customer:', error);
                alert('Error deleting customer: ' + error.message);
            });
        }

        // Modal functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function switchToEditFromView() {
            closeModal('customerViewModal');
            editCustomer(currentCustomerId, currentCustomerName);
        }

        function switchToDeleteFromView() {
            closeModal('customerViewModal');
            openModal('customerDeleteModal');
        }

        // Toggle sidebar for mobile
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const menuToggle = document.querySelector('.menu-toggle');
            
            if (window.innerWidth <= 1024 && 
                !sidebar.contains(event.target) && 
                !menuToggle.contains(event.target) && 
                sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
            }
        });

        // Search function
        function searchCustomers() {
            const searchInput = document.getElementById('searchInput');
            const searchTerm = searchInput.value.toLowerCase();
            const rows = document.querySelectorAll('#customerTableBody tr');
            
            let visibleCount = 0;
            
            rows.forEach(row => {
                // Skip the loading/error rows
                if (row.classList.contains('loading') || row.classList.contains('error')) {
                    return;
                }
                
                const cells = row.querySelectorAll('td');
                let rowText = '';
                
                // Get text from first 3 columns (skip actions column)
                for (let i = 0; i < Math.min(3, cells.length); i++) {
                    rowText += cells[i].textContent.toLowerCase() + ' ';
                }
                
                if (rowText.includes(searchTerm)) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            });
            
            // If no rows visible and we have a search term
            if (visibleCount === 0 && searchTerm.trim() !== '') {
                const noResultsRow = document.createElement('tr');
                noResultsRow.innerHTML = '<td colspan="4" class="loading">No customers found matching your search</td>';
                document.getElementById('customerTableBody').appendChild(noResultsRow);
            }
        }

        // Set up search input event listener
        document.getElementById('searchInput').addEventListener('input', searchCustomers);

        // Load customers when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, loading customers...');
            loadCustomers();
            
            // Set admin name from localStorage or default
            const adminName = localStorage.getItem('adminName') || 'Admin User';
            document.getElementById('adminName').textContent = adminName;
            document.querySelector('.user-avatar span').textContent = adminName.charAt(0).toUpperCase();
        });
    </script>
</body>
</html>