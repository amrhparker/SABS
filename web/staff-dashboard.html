<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SALONIX - Staff Dashboard</title>

<style>

/* RESET */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Inter, Arial, sans-serif;
    background: #f6f7fb;
    overflow-x: hidden;
}

/* ================= BACKGROUND ================= */

.admin-bg {
    position: fixed;
    inset: 0;
    z-index: -1;
}

.admin-bg img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.admin-bg::after {
    content: "";
    position: absolute;
    inset: 0;
    backdrop-filter: blur(5px);
    background: rgba(0,0,0,0.35);
}

/* ================= TOP BAR ================= */

.top-bar {
    position: fixed; /* keep it fixed at top */
    top: 0;
    left: 0;
    width: 100%;
    height: 70px;
    background: white;
    display: flex;
    justify-content: flex-end; /* align everything to the right */
    align-items: center;
    padding: 0 24px;
    box-shadow: 0 4px 20px rgba(0,0,0,.05);
    z-index: 10;
}

.menu-icon {
    cursor: pointer;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 10px;
}

.avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: #ddd;
}

.user-name {
    font-size: 14px;
    font-weight: 600;
}

.user-role {
    font-size: 12px;
    color: gray;
}

/* ================= MAIN CONTENT ================= */

.main-content {
    padding: 110px 32px 40px;
    max-width: 1200px;
    margin: auto;
}

/* ================= DASHBOARD CARDS ================= */

.dashboard-row {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
}

/* Welcome Card */

.welcome-card {
    flex: 2;
    background: white;
    padding: 20px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 16px;
    box-shadow: 0 5px 25px rgba(0,0,0,.06);
}

.welcome-avatar {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
}

.welcome-text {
    font-size: 14px;
    color: #6b7280;
}

.welcome-name {
    font-size: 22px;
    font-weight: 700;
}

/* Total Card */

.total-card {
    flex: 1;
    background: white;
    padding: 20px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 14px;
    box-shadow: 0 5px 25px rgba(0,0,0,.06);
}

.total-icon {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: #eef2ff;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.total-label {
    font-size: 14px;
    color: gray;
}

.total-value {
    font-size: 24px;
    font-weight: 700;
}

/* ================= TABLE ================= */

.table-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 24px;
    background: #FFF;
    border: 1px solid #F0F1F3;
    border-bottom: none;
    gap: 12px;
    flex-wrap: wrap;
}

.services-actions {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
}

.search-box {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #5C59E8;
            background: #F9F9FC;
            min-width: 200px;
        }

.search-box svg {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .search-box input {
            border: none;
            background: transparent;
            outline: none;
            flex: 1;
            color: #333843;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
        }

.table-card {
    background: white;
    margin-top: 30px;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 5px 25px rgba(0,0,0,.06);
}

.table-title {
    font-weight: 600;
    margin-bottom: 15px;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 14px;
    border-bottom: 1px solid #eee;
    font-size: 14px;
}

th {
    color: gray;
    text-align: left;
}

/* Status Badges */

.status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
}

.status-badge.coming-soon { background: #fff3e0; color: #fb8c00; }
.status-badge.ongoing      { background: #fff9c4; color: #f9a825; }
.status-badge.completed    { background: #e8f5e9; color: #43a047; }
.status-badge.cancelled    { background: #fdecea; color: #e53935; }

.action-buttons {
    display: none;
}

/* Footer Button */

.table-footer {
    display: flex;
    justify-content: flex-end;
    margin-top: 16px;
}

.view-btn {
    background: #6366f1;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 6px;
    cursor: pointer;
}

.view-btn:hover {
    opacity: .9;
}

/* ================= RESPONSIVE ================= */

@media(max-width: 768px) {

.dashboard-row {
    flex-direction: column;
}

.table-header {
    flex-direction: column;
    align-items: stretch;
}

.services-actions {
    width: 100%;
    flex-direction: column;
}

.search-box {
    width: 100%;
}

}

</style>
</head>

<body>

<!-- BACKGROUND -->
<div class="admin-bg">
    <img src="https://api.builder.io/api/v1/image/assets/TEMP/1952c35b9d9f3235ef7d57200dcbbf59971acb5d?width=2880">
</div>

<!-- TOP BAR -->
<div class="top-bar">

    <!-- User Info -->
    <div class="user-info">
        <div><img src="https://randomuser.me/api/portraits/women/44.jpg" class="avatar"></div>
        <div>
            <div class="user-name" id="staffName"></div>
            <div class="user-role">Staff</div>
        </div>
        <div>
            <a href="login.html">
                <img src="images/logoutIcon.png" class="avatar">
            </a>
        </div>
    </div>

</div>

<!-- MAIN CONTENT -->
<div class="main-content">

    <!-- DASHBOARD ROW -->
    <div class="dashboard-row">

        <!-- Welcome Card -->
        <div class="welcome-card">

            <img src="https://randomuser.me/api/portraits/women/44.jpg" class="welcome-avatar">

            <div>
                <div class="welcome-text">Hello,</div>
                <div class="welcome-name" id="welcomeName"></div>
            </div>

        </div>

        <!-- Total Appointments -->
        <div class="total-card">

            <div class="total-icon">ðŸ“…</div>

            <div>
                <div class="total-label">Total Appointments</div>
                <div class="total-value"></div>
            </div>

        </div>

    </div>

    <!-- RECENT APPOINTMENTS -->
    <div class="table-card">

        <div class="table-header">
            <h2 class="table-title">List of Appointments</h2>
                <div class="services-actions">
                    <div class="search-box">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M14.7844 16.1991C11.646 18.6416 7.10629 18.4205 4.22156 15.5358C1.09737 12.4116 1.09737 7.34625 4.22156 4.22205C7.34576 1.09786 12.4111 1.09786 15.5353 4.22205C18.42 7.10677 18.6411 11.6464 16.1986 14.7849L20.4851 19.0713C20.8756 19.4618 20.8756 20.095 20.4851 20.4855C20.0945 20.876 19.4614 20.876 19.0708 20.4855L14.7844 16.1991ZM5.63578 14.1215C7.97892 16.4647 11.7779 16.4647 14.1211 14.1215C16.4642 11.7784 16.4642 7.97941 14.1211 5.63627C11.7779 3.29312 7.97892 3.29312 5.63578 5.63627C3.29263 7.97941 3.29263 11.7784 5.63578 14.1215Z" fill="#667085"/>
                        </svg>
                        <input type="text" id="searchInput" placeholder="Search appointment..." onkeyup="handleSearch()">
                    </div>
                </div>
        </div>

        <table>

            <thead>
                <tr>
                    <th>Appointment ID</th>
                    <th>Customer ID</th>
                    <th>Date | Time</th>
                    <th>Service</th>
                    <th>Status</th>
                </tr>
            </thead>

            <tbody>
                <tr></tr>
            </tbody>

        </table>
    </div>
</div>

<!-- OPTIONAL SERVLET NAME FETCH -->
<script>

    fetch('StaffNameServlet')
        .then(response => response.text()) // plain text
        .then(name => {
            document.getElementById('staffName').textContent = name;
            document.getElementById('welcomeName').textContent = name;
        })
        .catch(err => {
            console.error(err);
            document.getElementById('staffName').textContent = "";
            document.getElementById('welcomeName').textContent = "";
        });
    
    function loadAppointments() {
    fetch('AppointmentServlet')
        .then(response => response.text())
        .then(html => {
            const tbody = document.querySelector('table tbody');
            tbody.innerHTML = html;

            // Remove action buttons column
            tbody.querySelectorAll('tr').forEach(tr => {
                tr.removeChild(tr.lastElementChild);
            });

            // Count total appointments
            const total = tbody.querySelectorAll('tr').length;
            document.querySelector('.total-value').textContent = total;
        })
        .catch(err => console.error(err));
}

function handleSearch() {
    const input = document.getElementById("searchInput");
    const filter = input.value.toLowerCase();
    const table = document.querySelector("table");
    const rows = table.getElementsByTagName("tr");

    // Loop through all table rows (skip header row)
    for (let i = 1; i < rows.length; i++) {
        let rowText = rows[i].textContent.toLowerCase();

        if (rowText.includes(filter)) {
            rows[i].style.display = "";
        } else {
            rows[i].style.display = "none";
        }
    }
}

loadAppointments();
</script>

</body>
</html>
